<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2022b"><title>Toy Problem </title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S2 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S3 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S4 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 1px solid rgb(191, 191, 191); border-bottom: 1px solid rgb(191, 191, 191); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S6 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 1px solid rgb(191, 191, 191); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(191, 191, 191); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 1px solid rgb(191, 191, 191); border-bottom: 1px solid rgb(191, 191, 191); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2019 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: rgb(255,100,0);    text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: rgb(230,0,0);    text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Toy Problem </span></h1><ul  class = 'S1'><li  class = 'S2'><span>This is for practicing the gradient domain process. </span></li><li  class = 'S2'><span>I first compute the gradient values of the given image, and reconstruct the image with the gradient informations and one pixel intensity.</span></li></ul><h3  class = 'S3'><span>Load Image </span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >toyim = im2double(imread(</span><span style="color: rgb(167, 9, 245);">'./data/toy_problem.png'</span><span >)); </span></span></div></div></div><h3  class = 'S5'><span>Variables for construct the linear equation</span></h3><ul  class = 'S1'><li  class = 'S2'><span>To reconstruct the image, I should solve a least square problem, which can be expressed in matrix form Ax=b. </span></li><li  class = 'S2'><span>I make a matrix A with the require size</span></li><li  class = 'S2'><span>The number of rows is set as the number of pixel values to infer. </span></li><li  class = 'S2'><span>The number of columns is set as the number of expressions required for operation.</span></li><li  class = 'S2'><span>Let s be the given image. </span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >[imh, imw, nn] = size(toyim);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >im2var = zeros(imh, imw);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >im2var(1:imh*imw) = 1:imh*imw;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >nrow = imh*imw;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >ncol = (imw-1)*imh+imw*(imh-1)+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >A = zeros(ncol,nrow);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >s = toyim;</span></span></div></div></div><ul  class = 'S1'><li  class = 'S2'><span>With the im2var function, I index the pixel values. This is for allocating necessary operations for each pixel.</span></li><li  class = 'S2'><span>The x,y gradient values of the image could simply computed as the difference between the adjacent pixels (x_t+1-x_t) (y_t+1-y_t)</span></li><li  class = 'S2'><span> The matrix expression can be categorized as three parts. </span></li><li  class = 'S2'><span>(1-2) computing x,y gradients respectively which minimize the difference between the gradient of given image and the inferred image. Left term of equation expresses the gradient values that we need to infer and the right term shows the gradient values of the given image. </span></li><li  class = 'S2'><span>(3) To reconstruct the image perfectly, we need to know the offset of the pixel value. Therefore, we should add one constraint that one pixel intensity of the reconstructed image should follow the corresponding pixel value of the given image. </span></li><li  class = 'S2'><span>The below for loops compute those three parts. </span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >e = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >y = 1:imh</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >x = 1:imw-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        e = e+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        A(e, im2var(y,x+1)) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        A(e,im2var(y,x)) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        b(e) = s(y,x+1) - s(y,x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >x = 1:imw</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >y = 1:imh-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        e = e+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        A(e, im2var(y+1,x)) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        A(e,im2var(y,x)) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        b(e) = s(y+1,x) - s(y,x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >A(e+1,im2var(1,1)) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >b(e+1) = s(1,1);</span></span></div></div></div><ul  class = 'S1'><li  class = 'S2'><span>After the for loops, we can get the full matrix A and b.</span></li><li  class = 'S2'><span>Then with right division operator "\", we can get the infered pixel values v. </span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >B = transpose(b);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >v = A\B;</span></span></div></div></div><ul  class = 'S1'><li  class = 'S2'><span>I reconstruct the image with the indexed pixel values in v. </span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >output = zeros(imh,imw);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >n=0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >j = 1:imw</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">for </span><span >i = 1:imh</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        n = n+1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >        output(i,j) = v(n);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><img class = "imageNode" src = "data:image/png;base64,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" width = "110" height = "119" alt = "toy_example_recon.png" style = "vertical-align: baseline; width: 110px; height: 119px;"></img></div><ul  class = 'S1'><li  class = 'S2'><span>The reconstructed image looks same as the original image. </span></li><li  class = 'S2'><span>I also compute the error of reconstructed image, and it is almost zero. </span></li></ul><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S10'><span style="white-space: pre"><span >disp([</span><span style="color: rgb(167, 9, 245);">'Error: ' </span><span >num2str(sqrt(sum(abs(toyim(:)-output(:)))))])</span></span></div><div  class = 'S11'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="400EE000" prevent-scroll="true" data-testid="output_0" style="width: 846px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent" data-width="816" data-height="17" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">Error: 4.0251e-06</div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >imwrite(output,</span><span style="color: rgb(167, 9, 245);">'toy_example_recon.png'</span><span >)</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Toy Problem 
%% 
% * This is for practicing the gradient domain process. 
% * I first compute the gradient values of the given image, and reconstruct 
% the image with the gradient informations and one pixel intensity.
% Load Image 

toyim = im2double(imread('./data/toy_problem.png')); 
% Variables for construct the linear equation
%% 
% * To reconstruct the image, I should solve a least square problem, which can 
% be expressed in matrix form Ax=b. 
% * I make a matrix A with the require size
% * The number of rows is set as the number of pixel values to infer. 
% * The number of columns is set as the number of expressions required for operation.
% * Let s be the given image. 

[imh, imw, nn] = size(toyim);
im2var = zeros(imh, imw);
im2var(1:imh*imw) = 1:imh*imw;

nrow = imh*imw;
ncol = (imw-1)*imh+imw*(imh-1)+1;
A = zeros(ncol,nrow);
s = toyim;
%% 
% * With the im2var function, I index the pixel values. This is for allocating 
% necessary operations for each pixel.
% * The x,y gradient values of the image could simply computed as the difference 
% between the adjacent pixels (x_t+1-x_t) (y_t+1-y_t)
% * The matrix expression can be categorized as three parts. 
% * (1-2) computing x,y gradients respectively which minimize the difference 
% between the gradient of given image and the inferred image. Left term of equation 
% expresses the gradient values that we need to infer and the right term shows 
% the gradient values of the given image. 
% * (3) To reconstruct the image perfectly, we need to know the offset of the 
% pixel value. Therefore, we should add one constraint that one pixel intensity 
% of the reconstructed image should follow the corresponding pixel value of the 
% given image. 
% * The below for loops compute those three parts. 

e = 0;
for y = 1:imh
    for x = 1:imw-1
        e = e+1;
        A(e, im2var(y,x+1)) = 1;
        A(e,im2var(y,x)) = -1;
        b(e) = s(y,x+1) - s(y,x);
    end
end

for x = 1:imw
    for y = 1:imh-1
        e = e+1;
        A(e, im2var(y+1,x)) = 1;
        A(e,im2var(y,x)) = -1;
        b(e) = s(y+1,x) - s(y,x);
    end
end
A(e+1,im2var(1,1)) = 1;
b(e+1) = s(1,1);
%% 
% * After the for loops, we can get the full matrix A and b.
% * Then with right division operator "\", we can get the infered pixel values 
% v. 

B = transpose(b);
v = A\B;
%% 
% * I reconstruct the image with the indexed pixel values in v. 

output = zeros(imh,imw);

n=0;
for j = 1:imw
    for i = 1:imh
        n = n+1;
        output(i,j) = v(n);
    end
end
%% 
% 
%% 
% * The reconstructed image looks same as the original image. 
% * I also compute the error of reconstructed image, and it is almost zero. 

disp(['Error: ' num2str(sqrt(sum(abs(toyim(:)-output(:)))))])
%%
imwrite(output,'toy_example_recon.png')
##### SOURCE END #####
-->
</div></body></html>